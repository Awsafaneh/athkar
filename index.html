<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق الأذكار والصلاة</title>

    <meta name="theme-color" content="#2c6959">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="logoa.png" type="image/png">
    <link rel="apple-touch-icon" href="logoa.png">

    <style>
        :root {
            --primary-color: #2c6959;
            --secondary-color: #1e4b3f;
            --accent-color: #d4ac6e;
            --text-color: #333;
            --bg-color: #f7f9f8;
            --white-color: #ffffff;
            --shadow-light: rgba(0, 0, 0, 0.05);
            --shadow-dark: rgba(0, 0, 0, 0.1);
            --font-family: 'Tajawal', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@700&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-family);
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            color: var(--text-color);
            line-height: 1.7;
        }
        .container { max-width: 1100px; margin: 0 auto; padding: 1rem; }

        .header {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            color: var(--white-color);
            margin-bottom: 2rem;
            animation: fadeInDown 1s ease-out;
        }
        .header-logo {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .header h1 {
            font-size: clamp(2rem, 5vw, 2.8rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .header p {
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            opacity: 0.9;
        }

        .navigation-container {
            position: relative;
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }
        .menu-toggle {
            display: none;
            background: var(--white-color);
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 4px 15px var(--shadow-dark);
        }
        .menu-toggle svg { width: 24px; height: 24px; color: var(--primary-color); }
        
        .navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            transition: all 0.3s ease-in-out;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--white-color);
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            font-family: var(--font-family);
            color: var(--primary-color);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow-dark);
        }
        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px var(--shadow-dark);
        }
        .nav-btn.active {
            background: var(--accent-color);
            color: var(--text-color);
            font-weight: 700;
        }
        .nav-btn svg { width: 20px; height: 20px; }

        @media (max-width: 768px) {
            .menu-toggle { display: block; }
            .navigation {
                display: none;
                position: absolute;
                top: 60px;
                left: 50%;
                transform: translateX(-50%);
                flex-direction: column;
                background-color: var(--white-color);
                width: 90%;
                max-width: 300px;
                border-radius: 15px;
                padding: 1rem;
                box-shadow: 0 10px 30px rgba(0,0,0,0.15);
                z-index: 1000;
            }
            .navigation.active {
                display: flex;
            }
        }
        
        .page { display: none; animation: fadeIn 0.5s ease-out; }
        .page.active { display: block; }

        .card {
            background: var(--white-color);
            border-radius: 20px;
            padding: clamp(1.5rem, 4vw, 2rem);
            box-shadow: 0 10px 40px var(--shadow-light);
            margin-bottom: 1.5rem;
        }
        .card-title {
            font-size: clamp(1.5rem, 4vw, 1.8rem);
            font-weight: 700;
            color: var(--secondary-color);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .prayer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }
        .prayer-item {
            background: linear-gradient(145deg, var(--bg-color), #eaf2f0);
            border: 1px solid #e0e0e0;
            padding: 1.2rem;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }
        .prayer-item.next-prayer {
            transform: translateY(-5px);
            background: var(--primary-color);
            color: var(--white-color);
            box-shadow: 0 8px 20px rgba(44, 105, 89, 0.3);
        }
        .prayer-item.next-prayer .prayer-name,
        .prayer-item.next-prayer .prayer-time {
            color: var(--white-color);
        }
        .prayer-name { font-weight: 700; font-size: 1.1rem; color: var(--secondary-color); margin-bottom: 0.5rem; }
        .prayer-time { font-weight: 700; font-size: 1.3rem; color: var(--text-color); font-family: monospace; }

        .home-dashboard { text-align: center; }
        .home-dashboard h3 { font-size: 1.2rem; color: var(--secondary-color); margin-bottom: 1rem; }
        #next-prayer-countdown { font-size: 2rem; font-weight: 700; color: var(--primary-color); margin-bottom: 1.5rem; font-family: monospace; }
        #verse-of-the-day { border-top: 1px solid #eee; padding-top: 1.5rem; }
        #verse-of-the-day .verse-text { font-family: 'Amiri', serif; font-size: 1.4rem; margin-bottom: 0.5rem; font-style: italic; color: var(--secondary-color); }
        #verse-of-the-day .verse-surah { font-size: 1rem; color: #777; }
        #location-status { text-align: center; margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid #eee; font-size: 0.9rem; color: #888;}
        #location-status button {
            background: transparent; border: 1px solid var(--accent-color); color: var(--accent-color);
            padding: 5px 10px; border-radius: 15px; cursor: pointer; font-family: var(--font-family);
            margin-top: 5px;
        }

        .content-section {
            max-height: 70vh;
            overflow-y: auto;
            padding: 5px;
        }
        .content-section-inner { padding: 1rem; }
        .content-section::-webkit-scrollbar { width: 8px; }
        .content-section::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .content-section::-webkit-scrollbar-thumb { background: linear-gradient(135deg, var(--accent-color), var(--primary-color)); border-radius: 10px; }

        .sub-navigation {
            display: flex; justify-content: center; gap: 10px;
            margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid #eee;
            flex-wrap: wrap;
        }
        .sub-nav-btn {
            background: #e8f0ed; border: 1px solid transparent; color: var(--primary-color);
            padding: 10px 20px; border-radius: 20px; cursor: pointer;
            font-weight: 500; transition: all 0.3s ease; font-family: var(--font-family);
        }
        .sub-nav-btn.active, .sub-nav-btn:hover {
            background: var(--primary-color); color: var(--white-color);
            transform: translateY(-2px); box-shadow: 0 4px 10px var(--shadow-light);
        }
        .azkar-section, .deceased-section { display: none; }
        .azkar-section.active, .deceased-section.active { display: block; animation: fadeIn 0.5s; }

        .dua-item, .azkar-item {
            background: var(--bg-color); border-radius: 15px; padding: 1.5rem;
            margin-bottom: 1rem; border-right: 5px solid var(--accent-color);
            border-left: none;
            transition: all 0.3s ease;
        }
        .azkar-text, .dua-text { font-size: 1.2rem; line-height: 1.8; color: var(--text-color); }
        .azkar-source { font-size: 0.9rem; color: #888; margin-top: 1rem; font-style: italic; }
        .azkar-count {
            display: inline-block;
            background: var(--accent-color);
            color: #fff;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 700;
            margin-top: 1rem;
            margin-right: 5px;
        }

        .counter {
            display: flex; align-items: center; justify-content: center;
            gap: 15px; margin-top: 15px;
        }
        .tasabih-counter-btn {
            background: transparent; border:none; cursor: pointer;
            font-size: 2rem; color: var(--primary-color);
            transition: transform 0.2s ease;
        }
        .tasabih-counter-btn:hover { transform: scale(1.2); }
        .tasabih-counter-display {
            font-size: 1.2rem; font-weight: 700; color: var(--secondary-color);
            background: #e8f0ed; padding: 8px 20px; border-radius: 10px;
            min-width: 100px; text-align:center;
        }

        #quran-index {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }
        .surah-btn {
            display: flex; align-items: center; background: var(--bg-color); border: 1px solid #e0e0e0;
            padding: 1rem; border-radius: 10px; cursor: pointer; text-align: right; transition: all 0.3s ease;
            font-size: 1.1rem; font-weight: 500; font-family: var(--font-family);
        }
        .surah-btn:hover { transform: translateY(-3px); border-color: var(--primary-color); }
        .surah-btn .surah-number {
            background: var(--primary-color); color: var(--white-color); border-radius: 8px;
            padding: 5px 10px; font-weight: 700; margin-left: 1rem;
        }
        .surah-details { flex-grow: 1; }
        .surah-details span { font-size: 0.85rem; color: #777; display: block; }
        #quran-viewer { display: none; }
        #surah-bismillah { font-family: 'Amiri', 'Times New Roman', serif; }
        .ayah { font-family: 'Amiri', 'Times New Roman', serif; font-size: 1.5rem; line-height: 2.5; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
        .ayah-number {
            font-family: var(--font-family);
            background-color: var(--accent-color); color: var(--secondary-color); border-radius: 50%;
            width: 30px; height: 30px; display: inline-block; text-align: center; line-height: 30px;
            font-size: 1rem; margin-right: 10px;
        }
        .back-to-index-btn { margin-bottom: 1rem !important; }

        .site-footer {
            text-align: center;
            padding: 2rem 1rem 1rem 1rem;
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            margin-top: 2rem;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        .site-footer strong {
            font-weight: 700;
            color: var(--white-color);
        }

        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>
    <div class="container">
        <svg width="0" height="0" style="position:absolute;">
            <symbol id="icon-home" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></symbol>
            <symbol id="icon-quran" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></symbol>
            <symbol id="icon-beads" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 10a2 2 0 1 0 4 0 2 2 0 0 0-4 0Z"/><path d="M10.29 3.86a2 2 0 1 0 2.83 2.83A2 2 0 0 0 10.29 3.86Z"/><path d="M14 10a2 2 0 1 0 4 0 2 2 0 0 0-4 0Z"/><path d="M18.14 16.71a2 2 0 1 0 2.83-2.83 2 2 0 0 0-2.83 2.83Z"/><path d="M6 18a2 2 0 1 0-4 0 2 2 0 0 0 4 0Z"/><path d="M10.29 20.14a2 2 0 1 0 2.83-2.83 2 2 0 0 0-2.83 2.83Z"/><path d="M12 12a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/><path d="M6 12a2 2 0 1 0-4 0 2 2 0 0 0 4 0Z"/><path d="M18.14 6.71a2 2 0 1 0 2.83-2.83 2 2 0 0 0-2.83 2.83Z"/></symbol>
            <symbol id="icon-hands" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 10h1v1a2 2 0 0 0 4 0V5a3 3 0 0 0-6 0v1a2 2 0 0 0 4 0V5"/><path d="M17 10h1v1a2 2 0 0 0 4 0V5a3 3 0 0 0-6 0v1a2 2 0 0 0 4 0V5"/></symbol>
            <symbol id="icon-star" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></symbol>
            <symbol id="icon-menu" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></symbol>
        </svg>

        <header class="header">
            <img src="logoa.png" alt="شعار الموقع" class="header-logo">
            <h1>تطبيق الأذكار والصلاة</h1>
            <p>اللهم اعنا على ذكرك وشكرك وحسن عبادتك</p>
            <p> صدقة جارية عن روح المرحوم الحاج نمر عفانه (ابو بسام) وزوجته الحاجة عائشة الحمد (ام بسام)</p>
        </header>

        <div class="navigation-container">
            <button class="menu-toggle" onclick="toggleMenu()">
                <svg><use href="#icon-menu"></use></svg>
            </button>
            <nav class="navigation" id="main-nav">
                <button class="nav-btn active" onclick="showPage('home')"><svg><use href="#icon-home"></use></svg>الرئيسية</button>
                <button class="nav-btn" onclick="showPage('quran')"><svg><use href="#icon-quran"></use></svg>المصحف الشريف</button>
                <button class="nav-btn" onclick="showPage('azkar')"><svg><use href="#icon-beads"></use></svg>الأذكار</button>
                <button class="nav-btn" onclick="showPage('deceased')"><svg><use href="#icon-hands"></use></svg>أدعية للمتوفين</button>
                <button class="nav-btn" onclick="showPage('general')"><svg><use href="#icon-star"></use></svg>أدعية عامة</button>
            </nav>
        </div>

        <div id="home-page" class="page active">
            <div class="card">
                <h2 class="card-title">مواقيت الصلاة</h2>
                <div class="prayer-grid">
                    <div class="prayer-item" id="prayer-Fajr"><div class="prayer-name">الفجر</div><div class="prayer-time" id="fajr-time">--:--</div></div>
                    <div class="prayer-item" id="prayer-Sunrise"><div class="prayer-name">الشروق</div><div class="prayer-time" id="sunrise-time">--:--</div></div>
                    <div class="prayer-item" id="prayer-Dhuhr"><div class="prayer-name">الظهر</div><div class="prayer-time" id="dhuhr-time">--:--</div></div>
                    <div class="prayer-item" id="prayer-Asr"><div class="prayer-name">العصر</div><div class="prayer-time" id="asr-time">--:--</div></div>
                    <div class="prayer-item" id="prayer-Maghrib"><div class="prayer-name">المغرب</div><div class="prayer-time" id="maghrib-time">--:--</div></div>
                    <div class="prayer-item" id="prayer-Isha"><div class="prayer-name">العشاء</div><div class="prayer-time" id="isha-time">--:--</div></div>
                </div>
                <div id="location-status"></div>
            </div>
            <div class="card home-dashboard">
                <h3>⏳ الصلاة القادمة بعد</h3>
                <div id="next-prayer-countdown">جاري الحساب...</div>
                <div id="verse-of-the-day">
                    <h3>✨ آية اليوم</h3>
                    <p class="verse-text"></p>
                    <p class="verse-surah"></p>
                </div>
            </div>
        </div>

        <div id="quran-page" class="page">
            <div class="card">
                <div id="quran-viewer">
                    <button class="sub-nav-btn back-to-index-btn" onclick="showQuranIndex()">العودة إلى الفهرس</button>
                    <h3 id="surah-title" class="card-title" style="margin-top: 1.5rem;"></h3>
                    <p id="surah-bismillah" style="text-align: center; font-size: 1.8rem; margin-bottom: 20px;"></p>
                    <div id="surah-content" class="content-section" style="max-height: 60vh;"></div>
                </div>
                <div id="quran-index-container">
                    <h2 class="card-title">فهرس المصحف الشريف</h2>
                    <div id="quran-index-loader" style="text-align:center; font-size: 1.2rem;">جاري تحميل فهرس السور...</div>
                    <div id="quran-index" class="content-section" style="max-height: 65vh;"></div>
                </div>
            </div>
        </div>
        
        <div id="azkar-page" class="page">
            <div class="card">
                <h2 class="card-title">حصن المسلم</h2>
                <nav class="sub-navigation">
                    <button class="sub-nav-btn active" onclick="showAzkarSection('sabah', this)">أذكار الصباح</button>
                    <button class="sub-nav-btn" onclick="showAzkarSection('masaa', this)">أذكار المساء</button>
                    <button class="sub-nav-btn" onclick="showAzkarSection('wake', this)">أذكار الاستيقاظ</button>
                    <button class="sub-nav-btn" onclick="showAzkarSection('sleep', this)">أذكار النوم</button>
                    <button class="sub-nav-btn" onclick="showAzkarSection('salah', this)">أذكار بعد الصلاة</button>
                    <button class="sub-nav-btn" onclick="showAzkarSection('misc', this)">أذكار متفرقة</button>
                    <button class="sub-nav-btn" onclick="showAzkarSection('tasabih', this)">تسابيح</button>
                </nav>
                <div class="content-section">
                    <div class="content-section-inner">
                        <div id="azkar-sabah" class="azkar-section active">
                            <div class="azkar-item"><div class="azkar-text">أَعُوذُ بِاللهِ مِنْ الشَّيْطَانِ الرَّجِيمِ ﴿اللَّهُ لاَ إِلَهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ...﴾ - آية الكرسي.</div><div class="azkar-count">مرة واحدة</div><p class="azkar-source">من قالها حين يصبح أجير من الجن حتى يمسي.</p></div>
                            <div class="azkar-item"><div class="azkar-text">قراءة سورة الإخلاص، والفلق، والناس.</div><div class="azkar-count">ثلاث مرات</div><p class="azkar-source">من قالها ثلاث مرات حين يصبح وحين يمسي كفته من كل شيء.</p></div>
                            <div class="azkar-item"><div class="azkar-text">أَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ لِلَّهِ، وَالْحَمْدُ لِلَّهِ، لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ، رَبِّ أَسْأَلُكَ خَيْرَ مَا فِي هَذَا الْيَوْمِ وَخَيْرَ مَا بَعْدَهُ، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فِي هَذَا الْيَوْمِ وَشَرِّ مَا بَعْدَهُ، رَبِّ أَعُوذُ بِكَ مِنَ الْكَسَلِ وَسُوءِ الْكِبَرِ، رَبِّ أَعُوذُ بِكَ مِنْ عَذَابٍ فِي النَّارِ وَعَذَابٍ فِي الْقَبْرِ.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">اللهم بِكَ أَصْبَحْنَا، وَبِكَ أَمْسَيْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ وَإِلَيْكَ النُّشُورُ.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">اللهم أَنْتَ رَبِّي لاَ إِلَهَ إِلاَّ أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ بِذَنْبِي فَاغْفِرْ لِي فَإِنَّهُ لاَ يَغْفِرُ الذُّنُوبَ إِلاَّ أَنْتَ. (سيد الاستغفار)</div><div class="azkar-count">مرة واحدة</div><p class="azkar-source">من قالها موقناً بها حين يصبح، فمات من يومه دخل الجنة.</p></div>
                            <div class="azkar-item"><div class="azkar-text">اللهم إِنِّي أَصْبَحْتُ أُشْهِدُكَ، وَأُشْهِدُ حَمَلَةَ عَرْشِكَ، وَمَلاَئِكَتَكَ، وَجَمِيعَ خَلْقِكَ، أَنَّكَ أَنْتَ اللَّهُ لاَ إِلَهَ إِلاَّ أَنْتَ وَحْدَكَ لاَ شَرِيكَ لَكَ، وَأَنَّ مُحَمَّداً عَبْدُكَ وَرَسُولُكَ.</div><div class="azkar-count">أربع مرات</div><p class="azkar-source">من قالها أعتقه الله من النار.</p></div>
                            <div class="azkar-item"><div class="azkar-text">رَضِيتُ بِاللَّهِ رَبًّا، وَبِالإِسْلاَمِ دِينًا، وَبِمُحَمَّدٍ صلى الله عليه وسلم نَبِيًّا.</div><div class="azkar-count">ثلاث مرات</div><p class="azkar-source">من قالها كان حقاً على الله أن يرضيه يوم القيامة.</p></div>
                            <div class="azkar-item"><div class="azkar-text">بِسْمِ اللَّهِ الَّذِي لاَ يَضُرُّ مَعَ اسْمِهِ شَيْءٌ فِي الأَرْضِ وَلاَ فِي السَّمَاءِ وَهُوَ السَّمِيعُ الْعَلِيمُ.</div><div class="azkar-count">ثلاث مرات</div><p class="azkar-source">لم يضره من الله شيء.</p></div>
                            <div class="azkar-item"><div class="azkar-text">يَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ أَصْلِحْ لِي شَأْنِي كُلَّهُ وَلاَ تَكِلْنِي إِلَى نَفْسِي طَرْفَةَ عَيْنٍ.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">سُبْحَانَ اللَّهِ وَبِحَمْدِهِ: عَدَدَ خَلْقِهِ، وَرِضَا نَفْسِهِ، وَزِنَةَ عَرْشِهِ، وَمِدَادَ كَلِمَاتِهِ.</div><div class="azkar-count">ثلاث مرات</div></div>
                            <div class="azkar-item"><div class="azkar-text">أَصْبَحْنا عَلَى فِطْرَةِ الْإِسْلَامِ، وَعَلَى كَلِمَةِ الْإِخْلَاصِ، وَعَلَى دِينِ نَبِيِّنَا مُحَمَّدٍ صَلَّى اللهُ عَلَيْهِ وَسَلَّمَ، وَعَلَى مِلَّةِ أَبِينَا إِبْرَاهِيمَ حَنِيفًا مُسْلِمًا وَمَا كَانَ مِنَ الْمُشْرِكِينَ.</div><div class="azkar-count">مرة واحدة</div></div>
                        </div>
                        <div id="azkar-masaa" class="azkar-section">
                            <div class="azkar-item"><div class="azkar-text">أَعُوذُ بِاللهِ مِنْ الشَّيْطَانِ الرَّجِيمِ ﴿اللَّهُ لاَ إِلَهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ...﴾ - آية الكرسي.</div><div class="azkar-count">مرة واحدة</div><p class="azkar-source">من قالها حين يمسي أجير من الجن حتى يصبح.</p></div>
                             <div class="azkar-item"><div class="azkar-text">قراءة سورة الإخلاص، والفلق، والناس.</div><div class="azkar-count">ثلاث مرات</div><p class="azkar-source">تكفيه من كل شيء.</p></div>
                             <div class="azkar-item"><div class="azkar-text">أَمْسَيْنَا وَأَمْسَى الْمُلْكُ لِلَّهِ، وَالْحَمْدُ لِلَّهِ، لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ، رَبِّ أَسْأَلُكَ خَيْرَ مَا فِي هَذِهِ اللَّيْلَةِ وَخَيْرَ مَا بَعْدَهَا، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فِي هَذِهِ اللَّيْلَةِ وَشَرِّ مَا بَعْدَهَا، رَبِّ أَعُوذُ بِكَ مِنَ الْكَسَلِ وَسُوءِ الْكِبَرِ، رَبِّ أَعُوذُ بِكَ مِنْ عَذَابٍ فِي النَّارِ وَعَذَابٍ فِي الْقَبْرِ.</div><div class="azkar-count">مرة واحدة</div></div>
                             <div class="azkar-item"><div class="azkar-text">اللهم بِكَ أَمْسَيْنَا، وَبِكَ أَصْبَحْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ وَإِلَيْكَ الْمَصِيرُ.</div><div class="azkar-count">مرة واحدة</div></div>
                             <div class="azkar-item"><div class="azkar-text">اللهم أَنْتَ رَبِّي لاَ إِلَهَ إِلاَّ أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ... (سيد الاستغفار).</div><div class="azkar-count">مرة واحدة</div><p class="azkar-source">من قالها موقناً بها حين يمسي، فمات من ليلته دخل الجنة.</p></div>
                             <div class="azkar-item"><div class="azkar-text">اللهم إِنِّي أَمْسَيْتُ أُشْهِدُكَ، وَأُشْهِدُ حَمَلَةَ عَرْشِكَ...</div><div class="azkar-count">أربع مرات</div><p class="azkar-source">من قالها أعتقه الله من النار.</p></div>
                             <div class="azkar-item"><div class="azkar-text">أَعُوذُ بِكَلِمَاتِ اللَّهِ التَّامَّاتِ مِنْ شَرِّ مَا خَلَقَ.</div><div class="azkar-count">ثلاث مرات</div><p class="azkar-source">لم يضره شيء.</p></div>
                        </div>
                        <div id="azkar-wake" class="azkar-section">
                            <div class="azkar-item"><div class="azkar-text">الْحَمْـدُ لِلّهِ الّذي أَحْـيانا بَعْـدَ ما أَماتَـنا وَإليه النُّـشور.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">الْحَمْـدُ لِلّهِ الّذي عافاني في جَسَدي وَرَدّ عَليّ روحي وَأَذِنَ لي بِذِكْرِه.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">لا إلهَ إلاّ اللّهُ وَحْـدَهُ لا شَـريكَ له، لهُ المُلـكُ ولهُ الحَمـد، وهوَ على كلّ شيءٍ قدير، سُبْحانَ اللهِ، والحمْدُ لله، ولا إلهَ إلاّ اللهُ، واللهُ أكبَر، وَلا حَولَ وَلا قوّة إلاّ باللّهِ العليّ العظيم، رَبِّ اغْفرْ لي.</div><div class="azkar-count">مرة واحدة</div></div>
                        </div>
                        <div id="azkar-sleep" class="azkar-section">
                            <div class="azkar-item"><div class="azkar-text">بِاسْـمِكَ اللّهُـمَّ أَمـوتُ وَأَحْـيا.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">يجمع كفيه ثم ينفث فيهما فيقرأ: سورة الإخلاص، والفلق، والناس. ثم يمسح بهما ما استطاع من جسده يبدأ بهما على رأسه ووجهه وما أقبل من جسده.</div><div class="azkar-count">ثلاث مرات</div></div>
                            <div class="azkar-item"><div class="azkar-text">قراءة آية الكرسي: ﴿اللَّهُ لاَ إِلَهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ...﴾.</div><div class="azkar-count">مرة واحدة</div><p class="azkar-source">لا يزال عليك من الله حافظ ولا يقربك شيطان حتى تصبح.</p></div>
                            <div class="azkar-item"><div class="azkar-text">اللّهُـمَّ قِنـي عَذابَـكَ يَـوْمَ تَبْـعَثُ عِبـادَك.</div><div class="azkar-count">ثلاث مرات</div></div>
                            <div class="azkar-item"><div class="azkar-text">الْحَمْـدُ للهِ الَّذي أَطْعَمَنـا وَسَقـانا، وَكَفـانا، وَآوانا، فَكَـمْ مِمَّـنْ لا كـافِيَ لَـهُ وَلا مُـؤْوي.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">بِاسْـمِكَ رَبِّـي وَضَعْـتُ جَنْـبي، وَبِكَ أَرْفَعُـه، فَإِن أَمْسَـكْتَ نَفْسـي فارْحَـمْها، وَإِنْ أَرْسَلْتَـها فاحْفَظْـها بِمـا تَحْفَـظُ بِه عِبـادَكَ الصّـالِحـين.</div><div class="azkar-count">مرة واحدة</div></div>
                            <div class="azkar-item"><div class="azkar-text">سُبْحَانَ اللَّهِ (33 مرة)، الْحَمْدُ لِلَّهِ (33 مرة)، اللَّهُ أَكْبَرُ (34 مرة).</div><div class="azkar-count">عند النوم</div></div>
                        </div>
                        <div id="azkar-salah" class="azkar-section">
                            <div class="azkar-item"><div class="azkar-text">أَسْتَغْفِرُ اللهَ (ثلاثاً). اللهم أَنْتَ السَّلاَمُ، وَمِنْكَ السَّلَامُ، تَبَارَكْتَ يَا ذَا الْجَلَالِ وَالْإِكْرَامِ.</div></div>
                           <div class="azkar-item"><div class="azkar-text">لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ، اللهم لاَ مَانِعَ لِمَا أَعْطَيْتَ، وَلاَ مُعْطِيَ لِمَا مَنَعْتَ، وَلاَ يَنْفَعُ ذَا الْجَدِّ مِنْكَ الْجَدُّ.</div></div>
                           <div class="azkar-item"><div class="azkar-text">لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ. لاَ حَوْلَ وَلاَ قُوَّةَ إِلاَّ بِاللَّهِ، لاَ إِلَهَ إِلاَّ اللَّهُ، وَلاَ نَعْبُدُ إِلاَّ إِيَّاهُ، لَهُ النِّعْمَةُ وَلَهُ الْفَضْلُ وَلَهُ الثَّنَاءُ الْحَسَنُ، لاَ إِلَهَ إِلاَّ اللَّهُ مُخْلِصِينَ لَهُ الدِّينَ وَلَوْ كَرِهَ الْكَافِرُونَ.</div></div>
                           <div class="azkar-item"><div class="azkar-text">سُبْحَانَ اللهِ (33)، الْحَمْدُ لِلَّهِ (33)، اللهُ أَكْبَرُ (33)، ثم يكمل المئة بقول: "لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ".</div><p class="azkar-source">من قال ذلك دبر كل صلاة غفرت خطاياه وإن كانت مثل زبد البحر.</p></div>
                           <div class="azkar-item"><div class="azkar-text">قراءة آية الكرسي بعد كل صلاة مكتوبة.</div><p class="azkar-source">من قرأها دبر كل صلاة مكتوبة لم يمنعه من دخول الجنة إلا أن يموت.</p></div>
                           <div class="azkar-item"><div class="azkar-text">قراءة سورة الإخلاص والمعوذتين بعد كل صلاة مكتوبة مرة واحدة، وبعد صلاتي الفجر والمغرب ثلاث مرات.</div></div>
                           <div class="azkar-item"><div class="azkar-text">اللهم أَعِنِّي عَلَى ذِكْرِكَ وَشُكْرِكَ وَحُسْنِ عِبَادَتِكَ.</div></div>
                        </div>
                        <div id="azkar-misc" class="azkar-section">
                            <div class="azkar-item"><div class="azkar-text"><b>عند الخروج من المنزل:</b> بِسْمِ اللهِ، تَوَكَّلْتُ عَلَى اللهِ، وَلَا حَوْلَ وَلَا قُوَّةَ إِلَّا بِاللهِ.</div></div>
                            <div class="azkar-item"><div class="azkar-text"><b>عند دخول المنزل:</b> بِسْمِ اللهِ وَلَجْنَا، وَبِسْمِ اللهِ خَرَجْنَا، وَعَلَى رَبِّنَا تَوَكَّلْنَا، ثم ليسلم على أهله.</div></div>
                            <div class="azkar-item"><div class="azkar-text"><b>دعاء الركوب:</b> سُبْحَانَ الَّذِي سَخَّرَ لَنَا هَذَا وَمَا كُنَّا لَهُ مُقْرِنِينَ، وَإِنَّا إِلَى رَبِّنَا لَمُنْقَلِبُونَ.</div></div>
                            <div class="azkar-item"><div class="azkar-text"><b>دعاء السفر:</b> الله أكبر، الله أكبر، الله أكبر، {سُبْحَانَ الَّذِي سَخَّرَ لَنَا هَذَا...} اللهم إنا نسألك في سفرنا هذا البر والتقوى، ومن العمل ما ترضى... (إلى آخره).</div></div>
                            <div class="azkar-item"><div class="azkar-text"><b>عند دخول المسجد:</b> أَعُوذُ بِاللهِ الْعَظِيمِ، وَبِوَجْهِهِ الْكَرِيمِ، وَسُلْطَانِهِ الْقَدِيمِ، مِنَ الشَّيْطَانِ الرَّجِيمِ، بِسْمِ اللهِ، وَالصَّلَاةُ وَالسَّلَامُ عَلَى رَسُولِ اللهِ، اللهم افْتَحْ لِي أَبْوَابَ رَحْمَتِكَ.</div></div>
                            <div class="azkar-item"><div class="azkar-text"><b>عند الخروج من المسجد:</b> بِسْمِ اللهِ وَالصَّلَاةُ وَالسَّلَامُ عَلَى رَسُولِ اللهِ، اللهم إِنِّي أَسْأَلُكَ مِنْ فَضْلِكَ، اللهم اعْصِمْنِي مِنَ الشَّيْطَانِ الرَّجِيمِ.</div></div>
                        </div>
                        <div id="azkar-tasabih" class="azkar-section">
                           <div class="azkar-item"><div class="azkar-text">سُبْحَانَ اللَّهِ وَبِحَمْدِهِ</div><div class="counter"><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih1', -1)">-</button><div class="tasabih-counter-display" id="tasabih1-count">0 / 100</div><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih1', 1)">+</button></div></div>
                           <div class="azkar-item"><div class="azkar-text">أَسْتَغْفِرُ اللَّهَ وَأَتُوبُ إِلَيْهِ</div><div class="counter"><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih2', -1)">-</button><div class="tasabih-counter-display" id="tasabih2-count">0 / 100</div><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih2', 1)">+</button></div></div>
                           <div class="azkar-item"><div class="azkar-text">لَا إِلَهَ إِلَّا أَنْتَ سُبْحَانَكَ إِنِّي كُنْتُ مِنَ الظَّالِمِينَ</div><div class="counter"><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih5', -1)">-</button><div class="tasabih-counter-display" id="tasabih5-count">0 / 100</div><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih5', 1)">+</button></div></div>
                           <div class="azkar-item"><div class="azkar-text">لَا حَوْلَ وَلَا قُوَّةَ إِلَّا بِاللَّهِ</div><div class="counter"><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih3', -1)">-</button><div class="tasabih-counter-display" id="tasabih3-count">0 / 100</div><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih3', 1)">+</button></div></div>
                           <div class="azkar-item"><div class="azkar-text">اللهم صَلِّ وَسَلِّمْ عَلَى نَبِيِّنَا مُحَمَّدٍ</div><div class="counter"><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih4', -1)">-</button><div class="tasabih-counter-display" id="tasabih4-count">0 / 100</div><button class="tasabih-counter-btn" onclick="updateTasabihCounter('tasabih4', 1)">+</button></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="deceased-page" class="page">
             <div class="card">
                <h2 class="card-title">أدعية للمتوفين</h2>
                <nav class="sub-navigation deceased-nav">
                    <button class="sub-nav-btn active" onclick="showDeceased('nimer', this)">نمر محمد عفانه</button>
                    <button class="sub-nav-btn" onclick="showDeceased('aisha', this)">عائشة عواد الحمد</button>
                    <button class="sub-nav-btn" onclick="showDeceased('bashar', this)">بشار نمر عفانه</button>
                    <button class="sub-nav-btn" onclick="showDeceased('basma', this)">باسمة نمر عفانه</button>
                </nav>
                <div class="content-section">
                    <div class="content-section-inner">
                        <div id="deceased-nimer" class="deceased-section active"></div>
                        <div id="deceased-aisha" class="deceased-section"></div>
                        <div id="deceased-bashar" class="deceased-section"></div>
                        <div id="deceased-basma" class="deceased-section"></div>
                    </div>
                </div>
             </div>
        </div>
        
        <div id="general-page" class="page">
             <div class="card">
                <h2 class="card-title">أدعية عامة وشاملة</h2>
                <div class="content-section">
                    <div class="content-section-inner" id="general-duas-container"></div>
                </div>
             </div>
        </div>

        <footer class="site-footer">
            <p>&copy; <span id="current-year"></span> - Made by <strong>Aws Afaneh</strong></p>
        </footer>

    </div>

<script>
// --- START OF JAVASCRIPT ---

// --- 1. DATA & CONSTANTS ---
const deceasedDataMale = [
    "اللهم اغفر له وارحمه، وعافه واعف عنه، وأكرم نزله، ووسع مدخله، واغسله بالماء والثلج والبرد، ونقه من الخطايا كما ينقى الثوب الأبيض من الدنس.", "اللهم أبدله داراً خيراً من داره، وأهلاً خيراً من أهله، وزوجاً خيراً من زوجه، وأدخله الجنة، وأعذه من عذاب القبر، ومن عذاب النار.", "اللهم اجعل قبره روضة من رياض الجنة، ولا تجعله حفرة من حفر النار، اللهم افسح له في قبره مد بصره، وافرش قبره من فراش الجنة.", "اللهم إنه في ذمتك وحبل جوارك، فقه فتنة القبر، وعذاب النار، وأنت أهل الوفاء والحق، فاغفر له وارحمه، إنك أنت الغفور الرحيم.", "اللهم إنه عبدك وابن عبدك، خرج من الدنيا، وسعتها، ومحبوبيه، وأحبائه فيها، إلى ظلمة القبر، وما هو لاقيه.", "اللهم إنه كان يشهد أنك لا إله إلا أنت، وأن محمداً عبدك ورسولك، وأنت أعلم به، اللهم ثبته عند السؤال.", "اللهم يمن كتابه، ويسر حسابه، وثقل بالحسنات ميزانه، وثبت على الصراط أقدامه، وأسكنه في أعلى الجنات، بجوار حبيبك ومصطفاك صلى الله عليه وسلم.", "اللهم آنسه في وحدته، وفي وحشته، وفي غربته، اللهم أنزله منزلاً مباركاً، وأنت خير المنزلين.", "اللهم أنزله منازل الصديقين، والشهداء، والصالحين، وحسن أولئك رفيقاً.", "اللهم عامله بما أنت أهله، ولا تعامله بما هو أهله، واجزه عن الإحسان إحساناً، وعن الإساءة عفواً وغفراناً.", "اللهم إن كان محسناً فزد في حسناته، وإن كان مسيئاً فتجاوز عن سيئاته يا أرحم الراحمين.", "اللهم أدخله الجنة من غير مناقشة حساب، ولا سابقة عذاب.", "اللهم املأ قبره بالرضا، والنور، والفسحة، والسرور.", "اللهم انقله من مواطن الدود، وضيق اللحود، إلى جنات الخلود.", "اللهم لا تحرمنا أجره، ولا تفتنا بعده، واغفر لنا وله، واجمعنا معه في جنات النعيم يا رب العالمين."
];

const deceasedDataFemale = [
    "اللهم اغفر لها وارحمها وعافها واعف عنها، وأكرم نزلها ووسع مدخلها، واغسلها بالماء والثلج والبرد، ونقها من الخطايا كما ينقى الثوب الأبيض من الدنس.", "اللهم أبدلها داراً خيراً من دارها، وأهلاً خيراً من أهلها، وزوجاً خيراً من زوجها، وأدخلها الجنة وأعذها من عذاب القبر ومن عذاب النار.", "اللهم عاملها بما أنت أهله، ولا تعاملها بما هي أهله، اللهم اجزها عن الإحسان إحساناً، وعن الإساءة عفواً وغفراناً.", "اللهم إن كانت محسنة فزد في حسناتها، وإن كانت مسيئة فتجاوز عن سيئاتها، اللهم أدخلها الجنة من غير مناقشة حساب ولا سابقة عذاب.", "اللهم آنسها في وحدتها، وآنسها في وحشتها، وآنسها في غربتها، اللهم أنزلها منزلاً مباركاً وأنت خير المنزلين.", "اللهم أنزلها منازل الصديقين والشهداء والصالحين وحسن أولئك رفيقاً.", "اللهم اجعل قبرها روضة من رياض الجنة، ولا تجعله حفرة من حفر النار، اللهم افسح لها في قبرها مد بصرها، وافرش قبرها من فراش الجنة.", "اللهم أعذها من عذاب القبر، وجفاف الأرض عن جنبيها، اللهم املأ قبرها بالرضا والنور والفسحة والسرور.", "اللهم إنها في ذمتك وحبل جوارك، فقها فتنة القبر، وعذاب النار، وأنت أهل الوفاء والحق، فاغفر لها وارحمها إنك أنت الغفور الرحيم.", "اللهم إن أمتك وابنة عبدك احتاجت إلى رحمتك، وأنت غني عن عذابها، إن كانت محسنة فزد في حسناتها، وإن كانت مسيئة فتجاوز عنها.", "اللهم يمن كتابها، ويسر حسابها، وثقل بالحسنات ميزانها، وثبت على الصراط أقدامها، وأسكنها في أعلى الجنات بجوار حبيبك ومصطفاك ﷺ.", "اللهم آمنها من فزع يوم القيامة، ومن هول يوم القيامة، واجعل نفسها آمنة مطمئنة، ولقنها حجتها.", "اللهم اجعلها في بطن القبر مطمئنة، وعند قيام الأشهاد آمنة، وبجود رضوانك واثقة، وإلى أعلى درجاتك سابقة.", "اللهم اجعل عن يمينها نوراً، حتى تبعثها آمنة مطمئنة في نور من نورك.", "اللهم انظر إليها نظرة رضا، فإن من تنظر إليه نظرة رضا لا تعذبه أبداً.", "اللهم أسكنها فسيح الجنان، واغفر لها يا رحمن، وارحمها يا رحيم، وتجاوز عما تعلم يا عليم.", "اللهم اعف عنها، فإنك القائل \"ويعفو عن كثير\".", "اللهم إنها جاءت ببابك، وأناخت بجنابك، فَجُد عليها بعفوك وإكرامك وجود إحسانك.", "اللهم إن رحمتك وسعت كل شيء، فارحمها رحمة تطمئن بها نفسها، وتقر بها عينها.", "اللهم احشرها مع المتقين إلى الرحمن وفداً.", "اللهم لا نزكيها عليك، ولكنا نحسبها أنها آمنت وعملت صالحاً، فاجعل لها جزاء الضعف بما عملت، واجعلها في الغرفات من الآمنين."
];

const generalDuasData = [
  // Quranic Duas
  "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الْآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ.",
  "رَبَّنَا لَا تُزِغْ قُلُوبَنَا بَعْدَ إِذْ هَدَيْتَنَا وَهَبْ لَنَا مِن لَّدُنكَ رَحْمَةً إِنَّكَ أَنتَ الْوَهَّابُ.",
  "رَبَّنَا ظَلَمْنَا أَنفُسَنَا وَإِن لَّمْ تَغْفِرْ لَنَا وَتَرْحَمْنَا لَنَكُونَنَّ مِنَ الْخَاسِرِينَ.",
  "رَبَّنَا اغْفِرْ لِي وَلِوَالِدَيَّ وَلِلْمُؤْمِنِينَ يَوْمَ يَقُومُ الْحِسَابُ.",
  "رَبِّ اشْرَحْ لِي صَدْرِي وَيَسِّرْ لِي أَمْرِي وَاحْلُلْ عُقْدَةً مِّن لِّسَانِي يَفْقَهُوا قَوْلِي.",
  "رَبِّ زِدْنِي عِلْمًا.",
  "لَّا إِلَهَ إِلَّا أَنتَ سُبْحَانَكَ إِنِّي كُنتُ مِنَ الظَّالِمِينَ.",
  "رَبَّنَا تَقَبَّلْ مِنَّا إِنَّكَ أَنتَ السَّمِيعُ الْعَلِيمُ.",
  "رَبَّنَا أَفْرِغْ عَلَيْنَا صَبْرًا وَثَبِّتْ أَقْدَامَنَا وَانصُرْنَا عَلَى الْقَوْمِ الْكَافِرِينَ.",
  "رَبَّنَا لَا تُؤَاخِذْنَا إِن نَّسِينَا أَوْ أَخْطَأْنَا.",
  "رَبَّنَا وَلَا تَحْمِلْ عَلَيْنَا إِصْرًا كَمَا حَمَلْتَهُ عَلَى الَّذِينَ مِن قَبْلِنَا.",
  "رَبَّنَا وَلَا تُحَمِّلْنَا مَا لَا طَاقَةَ لَنَا بِهِ وَاعْفُ عَنَّا وَاغْفِرْ لَنَا وَارْحَمْنَا.",
  "رَبِّ اجْعَلْنِي مُقِيمَ الصَّلَاةِ وَمِن ذُرِّيَّتِي رَبَّنَا وَتَقَبَّلْ دُعَاءِ.",
  "حَسْبِيَ اللَّهُ لَا إِلَهَ إِلَّا هُوَ عَلَيْهِ تَوَكَّلْتُ وَهُوَ رَبُّ الْعَرْشِ الْعَظِيمِ.",
  "رَبِّ أَوْزِعْنِي أَنْ أَشْكُرَ نِعْمَتَكَ الَّتِي أَنْعَمْتَ عَلَيَّ وَعَلَى وَالِدَيَّ وَأَنْ أَعْمَلَ صَالِحًا تَرْضَاهُ وَأَدْخِلْنِي بِرَحْمَتِكَ فِي عِبَادِكَ الصَّالِحِينَ.",
  "رَبِّ هَبْ لِي حُكْمًا وَأَلْحِقْنِي بِالصَّالِحِينَ.",
  "رَبَّنَا هَبْ لَنَا مِنْ أَزْوَاجِنَا وَذُرِّيَّاتِنَا قُرَّةَ أَعْيُنٍ وَاجْعَلْنَا لِلْمُتَّقِينَ إِمَامًا.",
  "رَبِّ إِنِّي لِمَا أَنزَلْتَ إِلَيَّ مِنْ خَيْرٍ فَقِيرٌ.",
  
  // Prophetic Duas
  "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْهُدَى وَالتُّقَى وَالْعَفَافَ وَالْغِنَى.",
  "يَا مُقَلِّبَ الْقُلُوبِ ثَبِّتْ قَلْبِي عَلَى دِينِكَ.",
  "اللَّهُمَّ أَعِنِّي عَلَى ذِكْرِكَ وَشُكْرِكَ وَحُسْنِ عِبَادَتِكَ.",
  "اللَّهُمَّ أَصْلِحْ لِي دِينِي الَّذِي هُوَ عِصْمَةُ أَمْرِي، وَأَصْلِحْ لِي دُنْيَايَ الَّتِي فِيهَا مَعَاشِي، وَأَصْلِحْ لِي آخِرَتِي الَّتِي فِيهَا مَعَادِي، وَاجْعَلِ الْحَيَاةَ زِيَادَةً لِي فِي كُلِّ خَيْرٍ، وَاجْعَلِ الْمَوْتَ رَاحَةً لِي مِنْ كُلِّ شَرٍّ.",
  "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْعَجْزِ وَالْكَسَلِ، وَالْجُبْنِ وَالْبُخْلِ، وَالْهَرَمِ وَعَذَابِ الْقَبْرِ.",
  "اللَّهُمَّ آتِ نَفْسِي تَقْوَاهَا، وَزَكِّهَا أَنْتَ خَيْرُ مَنْ زَكَّاهَا، أَنْتَ وَلِيُّهَا وَمَوْلَاهَا.",
  "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ عِلْمٍ لَا يَنْفَعُ، وَمِنْ قَلْبٍ لَا يَخْشَعُ، وَمِنْ نَفْسٍ لَا تَشْبَعُ، وَمِنْ دَعْوَةٍ لَا يُسْتَجَابُ لَهَا.",
  "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْعَفْوَ وَالْعَافِيَةَ فِي الدُّنْيَا وَالْآخِرَةِ.",
  "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْعَفْوَ وَالْعَافِيَةَ فِي دِينِي وَدُنْيَايَ وَأَهْلِي وَمَالِي.",
  "اللَّهُمَّ اسْتُرْ عَوْرَاتِي، وَآمِنْ رَوْعَاتِي.",
  "اللَّهُمَّ احْفَظْنِي مِنْ بَيْنِ يَدَيَّ، وَمِنْ خَلْفِي، وَعَنْ يَمِينِي، وَعَنْ شِمَالِي، وَمِنْ فَوْقِي، وَأَعُوذُ بِعَظَمَتِكَ أَنْ أُغْتَالَ مِنْ تَحْتِي.",
  "اللَّهُمَّ عَافِنِي فِي بَدَنِي، اللَّهُمَّ عَافِنِي فِي سَمْعِي، اللَّهُمَّ عَافِنِي فِي بَصَرِي، لَا إِلَهَ إِلَّا أَنْتَ.",
  "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْكُفْرِ وَالْفَقْرِ، اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ عَذَابِ الْقَبْرِ، لَا إِلَهَ إِلَّا أَنْتَ.",
  "اللَّهُمَّ أَنْتَ رَبِّي لَا إِلَهَ إِلَّا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ لَكَ بِذَنْبِي فَاغْفِرْ لِي، فَإِنَّهُ لَا يَغْفِرُ الذُّنُوبَ إِلَّا أَنْتَ.",
  "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْهَمِّ وَالْحَزَنِ، وَالْعَجْزِ وَالْكَسَلِ، وَالْبُخْلِ وَالْجُبْنِ, وَضَلَعِ الدَّيْنِ وَغَلَبَةِ الرِّجَالِ.",
  "اللَّهُمَّ اجْعَلْ أَوْسَعَ رِزْقِكَ عَلَيَّ عِنْدَ كِبَرِ سِنِّي، وَانْقِطَاعِ عُمْرِي.",
  "اللَّهُمَّ اغْفِرْ لِي ذَنْبِي كُلَّهُ، دِقَّهُ وَجِلَّهُ، وَأَوَّلَهُ وَآخِرَهُ، وَعَلَانِيَتَهُ وَسِرَّهُ.",
  "اللَّهُمَّ إِنِّي أَعُوذُ بِرِضَاكَ مِنْ سَخَطِكَ، وَبِمُعَافَاتِكَ مِنْ عُقُوبَتِكَ، وَأَعُوذُ بِكَ مِنْكَ، لَا أُحْصِي ثَنَاءً عَلَيْكَ، أَنْتَ كَمَا أَثْنَيْتَ عَلَى نَفْسِكَ.",
  "اللَّهُمَّ رَحْمَتَكَ أَرْجُو، فَلَا تَكِلْنِي إِلَى نَفْسِي طَرْفَةَ عَيْنٍ، وَأَصْلِحْ لِي شَأْنِي كُلَّهُ، لَا إِلَهَ إِلَّا أَنْتَ.",
  "اللَّهُمَّ إِنِّي عَبْدُكَ، ابْنُ عَبْدِكَ، ابْنُ أَمَتِكَ، نَاصِيَتِي بِيَدِكَ، مَاضٍ فِيَّ حُكْمُكَ، عَدْلٌ فِيَّ قَضَاؤُكَ، أَسْأَلُكَ بِكُلِّ اسْمٍ هُوَ لَكَ، سَمَّيْتَ بِهِ نَفْسَكَ، أَوْ عَلَّمْتَهُ أَحَدًا مِنْ خَلْقِكَ، أَوْ أَنْزَلْتَهُ فِي كِتَابِكَ، أَوِ اسْتَأْثَرْتَ بِهِ فِي عِلْمِ الْغَيْبِ عِنْدَكَ، أَنْ تَجْعَلَ الْقُرْآنَ رَبِيعَ قَلْبِي، وَنُورَ صَدْرِي، وَجِلَاءَ حُزْنِي، وَذَهَابَ هَمِّي.",
  "اللَّهُمَّ اكْفِنِي بِحَلَالِكَ عَنْ حَرَامِكَ، وَأَغْنِنِي بِفَضْلِكَ عَمَّنْ سِوَاكَ.",
  "اللَّهُمَّ زِدْنَا وَلَا تَنْقُصْنَا، وَأَكْرِمْنَا وَلَا تُهِنَّا، وَأَعْطِنَا وَلَا تَحْرِمْنَا، وَآثِرْنَا وَلَا تُؤْثِرْ عَلَيْنَا، وَارْضِنَا وَارْضَ عَنَّا.",
  "اللَّهُمَّ إِنِّي أَسْأَلُكَ مِنَ الْخَيْرِ كُلِّهِ، عَاجِلِهِ وَآجِلِهِ، مَا عَلِمْتُ مِنْهُ وَمَا لَمْ أَعْلَمْ، وَأَعُوذُ بِكَ مِنَ الشَّرِّ كُلِّهِ، عَاجِلِهِ وَآجِلِهِ، مَا عَلِمْتُ مِنْهُ وَمَا لَمْ أَعْلَمْ.",
  "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْجَنَّةَ وَمَا قَرَّبَ إِلَيْهَا مِنْ قَوْلٍ أَوْ عَمَلٍ، وَأَعُوذُ بِكَ مِنَ النَّارِ وَمَا قَرَّبَ إِلَيْهَا مِنْ قَوْلٍ أَوْ عَمَلٍ.",
  "اللَّهُمَّ إِنِّي أَسْأَلُكَ مِمَّا سَأَلَكَ مِنْهُ مُحَمَّدٌ -صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ-، وَأَعُوذُ بِكَ مِمَّا اسْتَعَاذَ مِنْهُ مُحَمَّدٌ -صَلَّى اللَّهُ عَلَيْهِ وَسَلَّمَ-.",
  "اللَّهُمَّ إِنَّكَ عَفُوٌّ تُحِبُّ الْعَفْوَ فَاعْفُ عَنِّي.",
  "اللهم اهدني فيمن هديت، وعافني فيمن عافيت، وتولني فيمن توليت، وبارك لي فيما أعطيت، وقني شر ما قضيت، فإنك تقضي ولا يقضى عليك، وإنه لا يذل من واليت، تباركت ربنا وتعاليت.",
  "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ زَوَالِ نِعْمَتِكَ، وَتَحَوُّلِ عَافِيَتِكَ، وَفُجَاءَةِ نِقْمَتِكَ، وَجَمِيعِ سَخَطِكَ.",
  "اللهم الطف بنا في قضائك وقدرك لطفا يليق بكرمك يا أكرم الأكرمين.",
  "اللهم إنا نسألك أن ترزقنا حبك، وحب من يحبك، وحب كل عمل يقربنا إلى حبك.",
  "اللهم إنا نسألك زيادة في الدين، وبركة في العمر، وصحة في الجسد، وسعة في الرزق، وتوبة قبل الموت، وشهادة عند الموت، ومغفرة بعد الموت، وعفوا عند الحساب، وأمانا من العذاب.",
  "اللهم اجعلنا هادين مهتدين، غير ضالين ولا مضلين، سلما لأوليائك، حربا على أعدائك.",
  "اللهم إني أسألك خير المسألة، وخير الدعاء، وخير النجاح، وخير العمل، وخير الثواب، وخير الحياة، وخير الممات.",
  "اللهم ألف بين قلوبنا، وأصلح ذات بيننا، واهدنا سبل السلام، ونجنا من الظلمات إلى النور.",
];

const allVerses = [
    { text: "أَلَا بِذِكْرِ اللَّهِ تَطْمَئِنُّ الْقُلُوبُ", surah: "(الرعد: 28)" }, { text: "فَاذْكُرُونِي أَذْكُرْكُمْ وَاشْكُرُوا لِي وَلَا تَكْفُرُونِ", surah: "(البقرة: 152)" }, { text: "وَقَالَ رَبُّكُمُ ادْعُونِي أَسْتَجِبْ لَكُمْ", surah: "(غافر: 60)" }, { text: "وَمَن يَتَّقِ اللَّهَ يَجْعَل لَّهُ مَخْرَجًا وَيَرْزُقْهُ مِنْ حَيْثُ لَا يَحْتَسِبُ", surah: "(الطلاق: 2-3)" }, { text: "إِنَّ مَعَ الْعُسْرِ يُسْرًا", surah: "(الشرح: 6)" }
];
let prayerTimesData = {};
let nextPrayerInterval;
let apiDateInfo = {}; 

// --- 2. INITIALIZATION ---
document.addEventListener('DOMContentLoaded', () => {
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js')
            .then(reg => console.log('Service worker registered successfully', reg))
            .catch(err => console.log('Service worker registration failed', err));
    }
    populateDeceasedDuas();
    populateGeneralDuas();
    getPrayerTimes();
    loadQuranIndex();
    displayVerseOfTheDay();
    loadAllTasabihCounters();
    document.getElementById('current-year').textContent = new Date().getFullYear();
});

// --- 3. DATA POPULATION FUNCTIONS ---
function populateDeceasedDuas() {
    const nimerContainer = document.getElementById('deceased-nimer');
    const aishaContainer = document.getElementById('deceased-aisha');
    const basharContainer = document.getElementById('deceased-bashar');
    const basmaContainer = document.getElementById('deceased-basma');

    const generateHTML = (data) => data.map(dua => `<div class="dua-item"><div class="dua-text">${dua}</div></div>`).join('');
    
    const aishaHTML = `<h3 class="card-title" style="font-size: 1.5rem;">أدعية للمرحومة بإذن الله عائشة عواد الحمد</h3>` + generateHTML(deceasedDataFemale);

    nimerContainer.innerHTML = `<h3 class="card-title" style="font-size: 1.5rem;">أدعية للمرحوم بإذن الله نمر محمد عفانه</h3>` + generateHTML(deceasedDataMale);
    aishaContainer.innerHTML = aishaHTML;
    basharContainer.innerHTML = nimerContainer.innerHTML.replace(/نمر محمد عفانه/g, 'بشار نمر عفانه');
    basmaContainer.innerHTML = aishaHTML.replace(/عائشة عواد الحمد/g, 'باسمة نمر عفانه');
}

function populateGeneralDuas() {
    const container = document.getElementById('general-duas-container');
    container.innerHTML = generalDuasData.map(dua => `<div class="dua-item"><div class="dua-text">${dua}</div></div>`).join('');
}

function displayVerseOfTheDay() {
    const randomVerse = allVerses[Math.floor(Math.random() * allVerses.length)];
    document.querySelector('#verse-of-the-day .verse-text').textContent = `"${randomVerse.text}"`;
    document.querySelector('#verse-of-the-day .verse-surah').textContent = randomVerse.surah;
}

// --- 4. UI & NAVIGATION FUNCTIONS ---
function toggleMenu() { document.getElementById('main-nav').classList.toggle('active'); }

function showPage(pageId) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(`${pageId}-page`).classList.add('active');
    document.querySelector(`.nav-btn[onclick="showPage('${pageId}')"]`).classList.add('active');
    if (window.innerWidth <= 768) { document.getElementById('main-nav').classList.remove('active'); }
}

function showAzkarSection(sectionId, btn) {
    document.querySelectorAll('.azkar-section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('#azkar-page .sub-nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('azkar-' + sectionId).classList.add('active');
    btn.classList.add('active');
}
    
function showDeceased(deceasedId, btn) {
    document.querySelectorAll('.deceased-section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('#deceased-page .sub-nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('deceased-' + deceasedId).classList.add('active');
    btn.classList.add('active');
}

// --- 5. FUNCTIONAL LOGIC (COUNTERS, PRAYER TIMES, QURAN) ---
function updateTasabihCounter(id, change) {
    const display = document.getElementById(id + '-count');
    let [count, max] = display.textContent.split(' / ').map(Number);
    count = Math.max(0, count + change);
    display.textContent = `${count} / ${max}`;
    localStorage.setItem(id, count);
}

function loadAllTasabihCounters() {
    document.querySelectorAll('.tasabih-counter-display').forEach(el => {
        const id = el.id.replace('-count', '');
        const savedCount = localStorage.getItem(id);
        if (savedCount !== null) {
            el.textContent = `${savedCount} / ${el.textContent.split(' / ')[1]}`;
        }
    });
}

function formatTo12Hour(time) {
    if (!time || typeof time !== 'string') return '--:--';
    const [hourStr, minuteStr] = time.split(':');
    let hour = parseInt(hourStr, 10);
    const suffix = hour >= 12 ? 'م' : 'ص'; // م for مساء (PM), ص for صباح (AM)
    hour = ((hour + 11) % 12 + 1); // Convert 24h to 12h
    return `${hour.toString().padStart(2, '0')}:${minuteStr} ${suffix}`;
}

async function getPrayerTimes() {
    const locationStatus = document.getElementById('location-status');
    let coords = JSON.parse(localStorage.getItem('userLocation'));
    if (coords) {
        locationStatus.innerHTML = `الموقع محدد تلقائياً. <button onclick="updateLocation()">تغيير الموقع</button>`;
        return fetchDataForCoords(coords.lat, coords.lon);
    }
    locationStatus.innerHTML = 'يرجى السماح بالوصول إلى موقعك...';
    navigator.geolocation.getCurrentPosition(
        (position) => {
            coords = { lat: position.coords.latitude, lon: position.coords.longitude };
            localStorage.setItem('userLocation', JSON.stringify(coords));
            locationStatus.innerHTML = `تم حفظ موقعك بنجاح. <button onclick="updateLocation()">تغيير</button>`;
            fetchDataForCoords(coords.lat, coords.lon);
        },
        () => {
            locationStatus.innerHTML = `فشل تحديد الموقع. يتم عرض مواقيت عمّان. <button onclick="updateLocation()">حاول مجدداً</button>`;
            fetchDataForCoords(31.9539, 35.9106); // Default to Amman
        },
        { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
    );
}

function updateLocation() {
    localStorage.removeItem('userLocation');
    if(nextPrayerInterval) clearInterval(nextPrayerInterval);
    document.getElementById('next-prayer-countdown').textContent = 'تحديث الموقع...';
    getPrayerTimes();
}

// START: ✅ TIMING LOGIC UPDATED FOR HIGHER ACCURACY
async function fetchDataForCoords(lat, lon) {
    try {
        const method = 3; // Muslim World League - More globally accurate
        const tune = '0,8,0,8,8,8,8,0'; // Fine-tuning: Add 8 minutes to main prayers

        const response = await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=${method}&tune=${tune}`);
        const data = await response.json();
        
        if (data.code === 200) {
            prayerTimesData = data.data.timings;
            apiDateInfo = {
                readableDate: data.data.date.readable,
                timezone: data.data.meta.timezone
            };
            displayPrayerTimes(prayerTimesData);
            startNextPrayerCountdown();
        } else {
             document.getElementById('location-status').innerHTML += '<br>حدث خطأ أثناء جلب المواقيت.';
        }
    } catch(e) { 
        document.getElementById('location-status').innerHTML += '<br>فشل الاتصال لجلب المواقيت.';
    }
}
// END: ✅ TIMING LOGIC UPDATED

function displayPrayerTimes(times) {
    if (!times) return;
    document.getElementById('fajr-time').textContent = formatTo12Hour(times.Fajr);
    document.getElementById('sunrise-time').textContent = formatTo12Hour(times.Sunrise);
    document.getElementById('dhuhr-time').textContent = formatTo12Hour(times.Dhuhr);
    document.getElementById('asr-time').textContent = formatTo12Hour(times.Asr);
    document.getElementById('maghrib-time').textContent = formatTo12Hour(times.Maghrib);
    document.getElementById('isha-time').textContent = formatTo12Hour(times.Isha);
}

function startNextPrayerCountdown() {
    if (nextPrayerInterval) clearInterval(nextPrayerInterval);
    if (Object.keys(prayerTimesData).length === 0 || !apiDateInfo.readableDate) return;

    const prayerOrder = ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'];

    nextPrayerInterval = setInterval(() => {
        const now = new Date();
        let nextPrayerTime = null;
        let nextPrayerName = '';

        document.querySelectorAll('.prayer-item').forEach(item => item.classList.remove('next-prayer'));

        const createPreciseDate = (timeStr) => {
            const fullDateString = `${apiDateInfo.readableDate} ${timeStr}:00`;
            return new Date(fullDateString);
        };
        
        for (const prayer of prayerOrder) {
            const prayerDate = createPreciseDate(prayerTimesData[prayer]);
            if (prayerDate > now) {
                nextPrayerTime = prayerDate;
                nextPrayerName = prayer;
                break;
            }
        }
        
        if (!nextPrayerTime) {
            const fajrTime = prayerTimesData.Fajr;
            let tomorrow = new Date(createPreciseDate(fajrTime));
            tomorrow.setDate(tomorrow.getDate() + 1);
            nextPrayerTime = tomorrow;
            nextPrayerName = 'Fajr';
        }

        const nextPrayerElement = document.getElementById(`prayer-${nextPrayerName}`);
        if(nextPrayerElement) {
            nextPrayerElement.classList.add('next-prayer');
        }

        const diff = nextPrayerTime - now;
        if (diff > 0) {
            const hours = Math.floor(diff / 3600000);
            const minutes = Math.floor((diff % 3600000) / 60000);
            const seconds = Math.floor((diff % 60000) / 1000);
            document.getElementById('next-prayer-countdown').textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        } else {
            document.getElementById('next-prayer-countdown').textContent = 'حان الآن وقت الصلاة';
        }

    }, 1000);
}

async function loadQuranIndex() {
    const indexDiv = document.getElementById('quran-index');
    const loader = document.getElementById('quran-index-loader');
    try {
        const response = await fetch('https://api.alquran.cloud/v1/surah');
        const data = await response.json();
        if(data.code === 200) {
            loader.style.display = 'none';
            data.data.forEach(surah => {
                const btn = document.createElement('button');
                btn.className = 'surah-btn';
                btn.innerHTML = `<div class="surah-number">${surah.number}</div> <div class="surah-details">${surah.name} <span>${surah.revelationType === 'Meccan' ? 'مكية' : 'مدنية'} - ${surah.numberOfAyahs} آية</span></div>`;
                btn.onclick = () => loadSurah(surah.number);
                indexDiv.appendChild(btn);
            });
        } else { loader.textContent = 'حدث خطأ.'; }
    } catch (error) { loader.textContent = 'فشل الاتصال بالإنترنت.'; }
}

async function loadSurah(surahNumber) {
    document.getElementById('quran-index-container').style.display = 'none';
    const viewer = document.getElementById('quran-viewer');
    const contentDiv = document.getElementById('surah-content');
    viewer.style.display = 'block';
    contentDiv.innerHTML = '<div style="text-align:center; font-size: 1.2rem;">جاري تحميل السورة...</div>';
    try {
        const response = await fetch(`https://api.alquran.cloud/v1/surah/${surahNumber}`);
        const data = await response.json();
        if (data.code === 200) {
            const surah = data.data;
            document.getElementById('surah-title').textContent = `سورة ${surah.name}`;
            document.getElementById('surah-bismillah').textContent = (surah.number !== 9 && surah.number !== 1) ? 'بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيمِ' : '';
            contentDiv.innerHTML = surah.ayahs.map(ayah => {
                let ayahText = ayah.text;
                if (surah.number === 1 && ayah.numberInSurah === 1) {
                    ayahText = ayahText.replace('بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ', '');
                }
                return `<div class="ayah">${ayahText}<span class="ayah-number">${ayah.numberInSurah}</span></div>`;
            }).join('');
            document.querySelector('#quran-viewer .content-section').scrollTop = 0;
        } else { contentDiv.innerHTML = '<div style="text-align:center;">حدث خطأ.</div>'; }
    } catch (error) { contentDiv.innerHTML = '<div style="text-align:center;">فشل الاتصال بالإنترنت.</div>'; }
}

function showQuranIndex() {
    document.getElementById('quran-viewer').style.display = 'none';
    document.getElementById('quran-index-container').style.display = 'block';
}

</script>
</body>
</html>
